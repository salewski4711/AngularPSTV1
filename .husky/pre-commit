#!/bin/sh

# PrÃ¼fe ob design-tokens.ts geÃ¤ndert wurde
if git diff --cached --name-only | grep -q "design-tokens.ts"; then
  echo "âŒ ERROR: design-tokens.ts kann nicht direkt geÃ¤ndert werden!"
  echo "ğŸ“ Bitte erstelle einen Token-Request:"
  echo "   https://github.com/[repo]/issues/new?template=token-request.md"
  echo ""
  echo "âœ… Erlaubte Aktionen:"
  echo "   1. Nutze bestehende Tokens mit TokenUtils"
  echo "   2. Erstelle Token-Request-Issue fÃ¼r neue Tokens"
  echo "   3. Warte auf Genehmigung vom Design-System-Team"
  echo ""
  echo "â“ Warum? Token-Konsistenz ist kritisch fÃ¼r das Design System!"
  exit 1
fi

# ESLint Check fÃ¼r alle geÃ¤nderten TypeScript-Dateien
echo "ğŸ” PrÃ¼fe Code-QualitÃ¤t mit ESLint..."
CHANGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(ts|html)$')

if [ ! -z "$CHANGED_FILES" ]; then
  echo "$CHANGED_FILES" | xargs npx eslint
  
  if [ $? -ne 0 ]; then
    echo ""
    echo "âŒ ESLint-Fehler gefunden! Bitte behebe diese vor dem Commit."
    echo "ğŸ’¡ Tipp: Nutze 'npm run lint:fix' fÃ¼r automatische Fixes"
    exit 1
  fi
fi

echo "âœ… Alle Checks bestanden!"